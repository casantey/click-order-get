<app-navigation>
  <section>
    <div class="container">
      <div class="row">
        <div class="col">
          <app-head [head]="{title:'Orders'}"> </app-head>
        </div>
      </div>

      <div class="row">
        <div class="col-md"></div>
        <div class="col-md">
          <mat-card>
            <mat-card-content>
              <mat-form-field appearance="outline">
                <mat-label>Report</mat-label>
                <mat-select [(ngModel)]="selectedReport">
                  <mat-option value="1">
                    <span>Pending Orders</span>
                  </mat-option>
                  <mat-option value="2">
                    <span>Completed Orders</span>
                  </mat-option>
                  <mat-option value="3">
                    <span>All Orders</span>
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field appearance="outline">
                <mat-label>Period</mat-label>
                <mat-select [(ngModel)]="timePeriod">
                  <mat-option value="all">All</mat-option>
                  <mat-option value="today">Today</mat-option>
                  <mat-option value="yesterday">Yesterday</mat-option>
                  <mat-option value="week">Last Week</mat-option>
                  <mat-option value="month">Last Month</mat-option>
                  <mat-option value="year">Last Year</mat-option>
                  <!-- <mat-option value="date">Specific Date</mat-option>
                <mat-option value="range">Date Range</mat-option> -->
                </mat-select>
              </mat-form-field>

              <!-- <div class="row">
                <div class="col-sm"></div>
                <div class="col-sm"></div>
                <div
                  class="col-sm"
                  *ngIf="timePeriod=='date'||timePeriod=='range'"
                ></div>
              </div> -->
              <!-- End row -->
            </mat-card-content>
            <mat-card-actions>
              <div class="d-flex justify-content-center">
                <button
                  color="primary"
                  class="w-100"
                  [disabled]="loading"
                  (click)="getOrders()"
                  mat-raised-button
                >
                  <mat-icon>search</mat-icon>
                  <span>Get Orders</span>
                </button>
              </div>
            </mat-card-actions>
          </mat-card>
        </div>
        <div class="col-md"></div>
      </div>
      <div class="row">
        <div class="col-md">
          <mat-card>
            <div class="row">
              <div class="col-md">
                <mat-form-field appearance="outline">
                  <mat-label>Search</mat-label>
                  <input
                    matInput
                    [disabled]="loading||emptyTable"
                    (keyup)="applyFilter($event)"
                    placeholder="Search for vendor"
                    #input
                  />
                  <mat-icon matSuffix>search</mat-icon>
                </mat-form-field>
              </div>
            </div>

            <mat-progress-bar
              mode="indeterminate"
              *ngIf="loading"
            ></mat-progress-bar>

            <div class="row">
              <div class="col-md">
                <table mat-table [dataSource]="dataSource" matSort>
                  <ng-container matColumnDef="orderNo">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      Order Number
                    </th>
                    <td mat-cell *matCellDef="let row">{{row.orderNo}}</td>
                  </ng-container>

                  <ng-container matColumnDef="itemCategory">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      Item Category
                    </th>
                    <td mat-cell *matCellDef="let row">{{row.itemCategory}}</td>
                  </ng-container>

                  <ng-container matColumnDef="itemName">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      Item Name
                    </th>
                    <td mat-cell *matCellDef="let row">{{row.itemName}}</td>
                  </ng-container>

                  <ng-container matColumnDef="item_quantity">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      Item Quantity
                    </th>
                    <td mat-cell class="text-right" *matCellDef="let row">
                      {{row.item_quantity}}
                    </td>
                  </ng-container>

                  <ng-container matColumnDef="phone">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      Phone Number
                    </th>
                    <td mat-cell *matCellDef="let row">{{row.phone}}</td>
                  </ng-container>

                  <ng-container matColumnDef="orderStatus">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      Order Status
                    </th>
                    <td mat-cell *matCellDef="let row">{{row.orderStatus}}</td>
                  </ng-container>

                  <ng-container matColumnDef="dateCreated">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>
                      Order Date
                    </th>
                    <td mat-cell *matCellDef="let row">
                      {{row.dateCreated | date: "MMMM dd, YYYY"}}
                    </td>
                  </ng-container>

                  <!-- <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let row">
                      <button mat-icon-button disabled>
                        <mat-icon>more_vert</mat-icon>
                      </button>
                    </td>
                  </ng-container> -->

                  <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let element">
                      <!-- <a class="table-btn" (click)="viewCase(element)" mat-icon-button>
                          <mat-icon>assessement</mat-icon>
                        </a> -->
                      <button [matMenuTriggerFor]="tableMenu" mat-icon-button>
                        <mat-icon>more_vert</mat-icon>
                      </button>
                      <mat-menu #tableMenu="matMenu">
                        <button
                          routerLink="/orders/{{element.orderNo}}"
                          matTooltip="View Details"
                          mat-menu-item
                        >
                          <mat-icon>assessment</mat-icon>
                          <span>View Detials</span>
                        </button>
                        <button
                          (click)="viewMap(element.orderLat, element.orderLong)"
                          [disabled]="element.orderLong===0"
                          mat-menu-item
                        >
                          <mat-icon>pin_drop</mat-icon>
                          <span>View on map</span>
                        </button>
                      </mat-menu>
                      <!-- <a class="table-btn" *ngIf="element.type==='Covid-19'; else noDesc" routerLink="/covid/{{element.transcode}}" matTooltip="View Details" mat-icon-button>
                          <mat-icon>assessment</mat-icon>
                        </a>
                        <ng-template #noDesc>
                          <a class="table-btn" [routerLink]="element.transcode" matTooltip="View Details" mat-icon-button>
                            <mat-icon>assessment</mat-icon>
                          </a>
                        </ng-template> -->
                    </td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr
                    mat-row
                    *matRowDef="let row; columns: displayedColumns;"
                  ></tr>

                  <!-- Row shown when there is no matching data. -->
                  <!-- <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="`${displayedColumns.length}`">
                      <span class="mx-auto">
                        No data matching the filter "{{input.value}}"
                      </span>
                    </td>
                  </tr> -->
                </table>

                <div class="table-foot" *ngIf="emptyTable">
                  <div>
                    <h2 class="text-center">
                      There is nothing to report at the moment
                    </h2>
                  </div>
                  <!-- <div id="empty-table" *ngIf="connError">
                    <h3 class="text-center">Cannot connect to the server at the moment; check your connection and try
                      again</h3>
                  </div> -->
                </div>
                <!-- End flexbox -->

                <mat-paginator
                  [pageSizeOptions]="[5, 10, 25, 100]"
                ></mat-paginator>
              </div>
            </div>
          </mat-card>
        </div>
      </div>
    </div>
  </section>
</app-navigation>
